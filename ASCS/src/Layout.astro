---
const { title = "NADCA ASCS Prep" } = Astro.props;
---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <style>
      :root { --accent:#0a6cff; --accent-2:#00b3ff; --bg:#0b1220; --panel:#0e1628; --text:#e6eef8; --muted:#9fb3c8; }
      body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system; background: var(--bg); color: var(--text); }
      header, footer { background: var(--panel); padding: 16px 24px; }
      a { color: var(--accent); text-decoration: none; }
      main { padding: 24px; max-width: 1100px; margin: 0 auto; }
      .grid { display:grid; gap:16px; grid-template-columns: repeat(auto-fill, minmax(280px,1fr)); }
      .card { background:#0b1220; padding:16px; border-radius:16px; box-shadow: 0 4px 16px rgba(0,0,0,.25); }
      .btn { background:var(--accent); color:white; padding:10px 14px; border-radius:10px; display:inline-block; }
      nav a { margin-right:12px; }
      .badge { background:#1f2937; padding:4px 8px; border-radius:999px; font-size:12px; }
      .hero { display:flex; gap:32px; align-items:center; flex-wrap:wrap; }
      .hero img { max-width: 420px; width: 100%; border-radius: 16px; }
      h1, h2, h3 { color: #f3f4f6; }
      p { color: #cbd5e1; line-height: 1.6; }
      ul { color: #cbd5e1; }
      code { background:#111827; padding:2px 6px; border-radius:6px; }
      .floating-chat { position: fixed; right: 20px; bottom: 20px; }
      .chat-btn { background: var(--accent); color: white; border: 0; border-radius: 999px; padding: 14px 18px; cursor: pointer; }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <a href="/ASCS/">Home</a>
        <a href="/ASCS/ascs/">ASCS Track</a>
        <a href="/ASCS/resources/">Resources</a>
      </nav>
    </header>
    <main>
      <slot />
    </main>
    <footer>
      <small>© {new Date().getFullYear()} NADCA ASCS Prep (Unofficial). For study use. Standards © their owners.</small>
    </footer>
    <div class="floating-chat">
      <button class="chat-btn" id="openChat">AI Tutor</button>
    </div>
    <script type="module">
      const btn = document.getElementById('openChat');
      const TUTOR_URL = import.meta.env.PUBLIC_TUTOR_URL || 'https://ascs-ai-tutor.americlean.workers.dev'; // Cloudflare Worker endpoint (POST)
      let open = false;
      btn.addEventListener('click', async () => {
        open = !open;
        if (open) {
          const q = prompt('Ask the AI Tutor a question:');
          if (!q) return;
          try {
            const resp = await fetch(TUTOR_URL, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ messages: [{ role: 'user', content: q }] })
            });
            const data = await resp.json();
            const text = data.choices?.[0]?.message?.content || JSON.stringify(data);
            alert(text);
          } catch (e) {
            alert('Error contacting AI tutor proxy. Check your deployment/proxy settings.');
          }
        }
      });
    </script>
  </body>
</html>
