<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AmeriClean: Interactive Competitive Strategy Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Professional Blue & Warm Neutrals -->
    <!-- Application Structure Plan: A tabbed dashboard interface was selected to logically segment the vast amount of synthesized data from the three source reports. This prevents cognitive overload and allows for focused exploration. The structure is task-oriented: 1) Market Overview to set the stage with macro trends, 2) Competitor Analysis to deep-dive into specific rivals organized by threat level/tier, 3) Strategic Battlegrounds to analyze key market niches (HVAC, Real Estate Investors), and 4) Strategic Roadmap to present actionable recommendations and budgets. A new "Live Research" tab has been added to provide on-demand competitor intelligence, with functionality to persist researched companies into the main analysis view. A new "Strategic Synthesis" feature has been added to the Competitor Analysis tab to provide a dynamic, on-demand strategic plan. -->
    <!-- Visualization & Content Choices: 
        - Market Trends: Goal: Inform. Method: Icon-based cards (HTML/Tailwind with Unicode) for quick visual recognition of complex trends (Green, Tech, Health). Justification: More engaging and scannable than a text list.
        - Competitor Tiers: Goal: Organize/Compare. Method: Interactive buttons to filter competitors by tier (National, Local, Niche). Profiles are shown in cards with an accordion for detailed SWOT analysis. Interaction: Click to filter and expand. Justification: Manages a large number of competitors cleanly and allows for progressive disclosure of information.
        - HVAC NADCA Gap: Goal: Highlight Opportunity. Method: A styled HTML table with prominent red 'X' marks. Interaction: None needed. Justification: A simple, high-impact visual that immediately communicates the market vulnerability.
        - Investor Program: Goal: Explain Strategy. Method: Interactive card layout explaining the program's value proposition. Interaction: Hover effects to draw attention. Justification: Turns a strategic concept into a tangible, easy-to-understand feature.
        - Belfor Battle Card: Goal: Equip Sales. Method: An interactive card that reveals "Landmine Questions" on click. Interaction: Click to flip/reveal. Justification: A "gamified" element that makes strategic talking points memorable and engaging for the sales team.
        - Marketing Budget Chart: Goal: Inform/Compare. Method: Stacked Bar Chart (Chart.js/Canvas). Interaction: Hover for tooltips. Justification: Clearly visualizes the breakdown of one-time vs. recurring marketing investments.
        - Live Research Tool: Goal: Provide on-demand intelligence. Method: Input form triggering a JS function to fetch and display data. A new button allows the user to add the generated report to the main Competitor Analysis tab. Interaction: User types, clicks research, then clicks to add. Justification: Empowers the user with real-time data and allows them to dynamically build out their competitor list, making the dashboard a living document.
        - Strategic Synthesis: Goal: Analyze all data and provide dynamic guidance. Method: A button triggers a function that analyzes the current competitor dataset and generates a full report with text analysis and multiple charts (Polar Area for service overlap, Bubble for threat matrix, Doughnut for budget). The roadmap data is now dynamically pulled into this report. Interaction: Click to generate/update. Justification: Transforms the dashboard from a static report viewer into a dynamic strategic planning tool.
        - Roadmap Visuals: Goal: Provide clear visual summaries for the action plan. Method: Added a Gantt-style chart for timelines and a Doughnut chart for budget allocation directly to the Roadmap tab. Justification: Makes the strategic plan easier to understand at a glance.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f9fafb; }
        .tab-active { border-color: #2563EB; color: #2563EB; background-color: #DBEAFE; }
        .tab-inactive { border-color: transparent; color: #4B5563; }
        .content-section { display: none; }
        .content-active { display: block; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 350px; max-height: 450px; }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        .battle-card-inner { transform-style: preserve-3d; transition: transform 0.6s; }
        .battle-card:hover .battle-card-inner { transform: rotateY(180deg); }
        .battle-card-front, .battle-card-back { backface-visibility: hidden; -webkit-backface-visibility: hidden; }
        .battle-card-back { transform: rotateY(180deg); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .synthesis-chart-container { position: relative; width: 100%; max-width: 500px; margin-left: auto; margin-right: auto; height: 300px; max-height: 400px; }
        .roadmap-chart-container { position: relative; width: 100%; height: 250px; max-height: 300px; }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">AmeriClean Strategic Dashboard</h1>
            <p class="text-lg text-gray-600 mt-2">Competitive Landscape & Growth Blueprint for Billings, MT</p>
        </header>

        <nav class="flex flex-wrap justify-center border-b border-gray-200 mb-8">
            <button data-tab="market" class="nav-tab tab-active text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 focus:outline-none">Market Overview</button>
            <button data-tab="competitors" class="nav-tab tab-inactive text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 focus:outline-none">Competitor Analysis</button>
            <button data-tab="battlegrounds" class="nav-tab tab-inactive text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 focus:outline-none">Strategic Battlegrounds</button>
            <button data-tab="roadmap" class="nav-tab tab-inactive text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 focus:outline-none">Actionable Roadmap</button>
            <button data-tab="research" class="nav-tab tab-inactive text-sm md:text-base font-medium py-3 px-4 md:px-6 border-b-2 focus:outline-none">Live Research</button>
        </nav>

        <main>
            <!-- Market Overview Section -->
            <section id="market" class="content-section content-active">
                <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <h2 class="text-2xl font-bold mb-4 text-gray-900">Macro-Level Market Forces</h2>
                    <p class="text-gray-700 leading-relaxed">The Billings cleaning and restoration market is not operating in a vacuum. It is being shaped by powerful national trends that dictate customer expectations and create new avenues for competition. Understanding these forces‚ÄîSustainability, Technology, and Health‚Äîis the first step in developing a resilient and forward-thinking strategy for AmeriClean. This section outlines these key drivers and their direct impact on the local competitive environment.</p>
                </div>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <div class="flex items-center mb-3">
                            <span class="text-3xl mr-4">üåø</span>
                            <h3 class="text-xl font-semibold text-green-700">The "Green" Imperative</h3>
                        </div>
                        <p class="text-gray-600">Consumer demand for eco-friendly and health-conscious services is now a primary market driver. Competitors like Oxi Fresh and Covert Cleaning actively market their "green" credentials. This trend makes sustainability a competitive necessity, not a supplemental benefit.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <div class="flex items-center mb-3">
                            <span class="text-3xl mr-4">üíª</span>
                            <h3 class="text-xl font-semibold text-blue-700">The Technology Arms Race</h3>
                        </div>
                        <p class="text-gray-600">The industry is shifting from manual labor to technology-driven solutions. Competitors like Paul Davis market their use of AI, IoT sensors, and advanced diagnostics. Marketing technology's benefits (e.g., "non-invasive moisture detection") is key to justifying premium value.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <div class="flex items-center mb-3">
                            <span class="text-3xl mr-4">üõ°Ô∏è</span>
                            <h3 class="text-xl font-semibold text-red-700">The Post-Pandemic Client</h3>
                        </div>
                        <p class="text-gray-600">Expectations have permanently shifted from "looking clean" to "being healthy." Clients now demand hospital-grade disinfection and services that improve indoor air quality. This creates a major opportunity to market services like duct cleaning as a direct investment in family or employee health.</p>
                    </div>
                </div>
            </section>

            <!-- Competitor Analysis Section -->
            <section id="competitors" class="content-section">
                 <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <h2 class="text-2xl font-bold mb-4 text-gray-900">Billings Competitor Tiers</h2>
                    <p class="text-gray-700 leading-relaxed">The competitive landscape is a complex ecosystem of different company types, each posing a unique threat. We've organized the key players into three distinct tiers: the National Giants with massive brand power, the formidable Local Powerhouses who are winning on service and trust, and the Niche Specialists who compete intensely on specific services or price. Use the filters below to explore each tier and understand their strategies.</p>
                </div>
                <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-6" id="competitor-tier-selector">
                    <button data-tier="all" class="tier-btn bg-blue-600 text-white text-sm md:text-base font-medium py-2 px-4 rounded-full transition-colors duration-200">All Competitors</button>
                    <button data-tier="national" class="tier-btn bg-gray-200 text-gray-700 text-sm md:text-base font-medium py-2 px-4 rounded-full transition-colors duration-200">National Giants</button>
                    <button data-tier="local" class="tier-btn bg-gray-200 text-gray-700 text-sm md:text-base font-medium py-2 px-4 rounded-full transition-colors duration-200">Local Powerhouses</button>
                    <button data-tier="niche" class="tier-btn bg-gray-200 text-gray-700 text-sm md:text-base font-medium py-2 px-4 rounded-full transition-colors duration-200">Niche Specialists</button>
                </div>
                 <div class="text-center mb-8 border-t pt-6 border-gray-200">
                    <button id="synthesis-button" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        Generate Strategic Synthesis
                    </button>
                </div>
                <div id="synthesis-report-container" class="hidden"></div>
                <div id="competitor-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
            </section>

            <!-- Strategic Battlegrounds Section -->
            <section id="battlegrounds" class="content-section">
                <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <h2 class="text-2xl font-bold mb-4 text-gray-900">Key Strategic Battlegrounds</h2>
                    <p class="text-gray-700 leading-relaxed">Victory in the Billings market will be won not just by being a generalist, but by dominating specific, high-value niches and countering well-defined threats. This section analyzes two key opportunities‚Äîthe HVAC duct cleaning market and the "We Buy Houses" real estate investor segment‚Äîand provides a direct counter-strategy for neutralizing the threat from national giants like Belfor.</p>
                </div>
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-xl font-semibold mb-4 text-center">Battleground: HVAC Duct Cleaning</h3>
                        <p class="text-gray-600 mb-4">The Billings HVAC market has a critical, exploitable weakness: <strong class="text-red-600">no company is currently certified by the National Air Duct Cleaners Association (NADCA)</strong>. This creates a massive opportunity for AmeriClean to become the *only* provider with this gold-standard credential, instantly elevating its service to a new tier of professionalism and trust.</p>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-gray-100 text-gray-700 uppercase">
                                    <tr><th class="p-3">Competitor</th><th class="p-3 text-center">NADCA Certified?</th></tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200" id="hvac-table-body">
                                </tbody>
                            </table>
                        </div>
                         <p class="text-gray-600 mt-4"><strong>Counter-Strategy:</strong> Achieve NADCA certification and launch a health-focused marketing campaign. Reframe duct cleaning from a simple chore to an essential health service for families with allergies or respiratory concerns, positioning AmeriClean as the only medically-sound choice in Billings.</p>
                    </div>

                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-xl font-semibold mb-4 text-center">Battleground: Real Estate Investors</h3>
                        <p class="text-gray-600 mb-4">The "we buy houses" sector is a consistent source of non-emergency, project-based revenue. These investors' biggest pain point is unreliable contractors. AmeriClean can capture this market by becoming their indispensable partner.</p>
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                             <h4 class="font-bold text-blue-800">The "Investor Advantage Program"</h4>
                             <p class="text-sm text-blue-700 mt-2">A formalized B2B partnership offering:</p>
                             <ul class="list-disc list-inside mt-2 text-sm text-blue-700 space-y-1">
                                 <li><strong>Standardized Pricing:</strong> Predictable costs for budgeting.</li>
                                 <li><strong>Priority Scheduling:</strong> Faster flips and reduced holding costs.</li>
                                 <li><strong>Dedicated Contact:</strong> Streamlined communication.</li>
                                 <li><strong>Exclusive Leads:</strong> Potential access to off-market distressed properties.</li>
                             </ul>
                        </div>
                        <p class="text-gray-600 mt-4"><strong>Counter-Strategy:</strong> Move beyond one-off jobs to create a formal partnership program. This secures a recurring revenue stream that buffers against the volatility of emergency work and creates a powerful competitive moat.</p>
                    </div>
                </div>

                 <div class="mt-8 bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold mb-4 text-center">Counter-Strategy: The Belfor Battle Card</h3>
                    <p class="text-center text-gray-600 mb-4 max-w-3xl mx-auto">National giants like Belfor are formidable, but their scale is also a weakness. They often suffer from communication gaps, project delays, and impersonal service. Use this interactive battle card in sales conversations to highlight AmeriClean's local accountability and expose these vulnerabilities without being confrontational. Hover to reveal the "Landmine Questions."</p>
                    <div class="battle-card w-full max-w-lg mx-auto h-64 perspective-1000">
                        <div class="battle-card-inner relative w-full h-full">
                            <div class="battle-card-front absolute w-full h-full bg-gradient-to-br from-gray-700 to-gray-900 rounded-lg p-6 flex flex-col justify-center items-center text-white">
                                <h4 class="text-2xl font-bold">Why AmeriClean Wins</h4>
                                <p class="text-center mt-2">vs. National Chains</p>
                                <ul class="list-disc list-inside mt-4 text-gray-300 text-left">
                                    <li><strong>Local Accountability:</strong> Direct owner involvement.</li>
                                    <li><strong>Agile & Fast:</strong> No corporate red tape.</li>
                                    <li><strong>Superior Communication:</strong> Direct line to decision-makers.</li>
                                    <li><strong>Community Focus:</strong> We are your neighbors.</li>
                                </ul>
                                <p class="text-xs mt-4 text-gray-400">Hover Over Card</p>
                            </div>
                            <div class="battle-card-back absolute w-full h-full bg-yellow-400 rounded-lg p-6 flex flex-col justify-center text-gray-900">
                                 <h4 class="text-xl font-bold text-center mb-2">Landmine Questions</h4>
                                 <p class="text-xs text-center mb-3">(Ask a prospect considering a national chain)</p>
                                 <ol class="list-decimal list-inside text-sm space-y-2">
                                     <li>Who is my single, dedicated project manager, and will they be on-site daily?</li>
                                     <li>How do you ensure quality control with subcontractors?</li>
                                     <li>Can you walk me through your process for transparent, weekly billing updates?</li>
                                     <li>If an issue arises, can I speak directly with the local owner?</li>
                                 </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Strategic Roadmap Section -->
            <section id="roadmap" class="content-section">
                <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <h2 class="text-2xl font-bold mb-4 text-gray-900">AmeriClean's Growth Blueprint</h2>
                    <p class="text-gray-700 leading-relaxed">To capitalize on market opportunities and counter threats, a cohesive, multi-phased marketing and operational strategy is required. This blueprint outlines a plan to establish market dominance by fusing AmeriClean's unmatched expertise with a modern, customer-centric approach. The plan is structured in three progressive phases, each with a distinct goal, set of actions, and corresponding budget.</p>
                </div>
                <div class="grid lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-3">
                        <h3 class="text-xl font-semibold mb-4">Phased Implementation Plan</h3>
                        <div id="roadmap-accordion" class="space-y-3">
                        </div>
                    </div>
                    <div class="lg:col-span-2 space-y-8">
                         <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="text-xl font-semibold mb-4 text-center">Implementation Timeline</h3>
                            <div class="roadmap-chart-container">
                                <canvas id="timelineChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="text-xl font-semibold mb-4 text-center">Budget Allocation</h3>
                            <div class="roadmap-chart-container">
                                <canvas id="roadmapBudgetAllocationChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Live Research Section -->
            <section id="research" class="content-section">
                <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <h2 class="text-2xl font-bold mb-4 text-gray-900">On-Demand Competitor Intelligence</h2>
                    <p class="text-gray-700 leading-relaxed">Stay ahead of the market by researching any company in real-time. Enter the name of a new or existing competitor below to generate an automated competitive analysis based on publicly available online data. This tool provides a quick snapshot of their services, online presence, and potential strategic positioning.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm mb-8">
                    <div class="flex flex-col sm:flex-row gap-4">
                        <input type="text" id="research-input" class="flex-grow w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter company name (e.g., 'Acme Restoration Billings')">
                        <button id="research-button" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-md hover:bg-blue-700 transition-colors duration-200">Research</button>
                    </div>
                </div>
                <div id="research-results" class="mt-8">
                     <p class="text-center text-gray-500">Enter a company name above to begin your research.</p>
                </div>
            </section>
        </main>
    </div>

    <script>
        const tabs = document.querySelectorAll('.nav-tab');
        const sections = document.querySelectorAll('.content-section');
        const competitorTierSelector = document.getElementById('competitor-tier-selector');
        const competitorGrid = document.getElementById('competitor-grid');
        const researchInput = document.getElementById('research-input');
        const researchButton = document.getElementById('research-button');
        const researchResultsContainer = document.getElementById('research-results');
        const synthesisButton = document.getElementById('synthesis-button');
        const synthesisReportContainer = document.getElementById('synthesis-report-container');

        const competitorData = {
            servpro: { name: 'SERVPRO', tier: 'national', threat: 'High', summary: 'The most recognized brand, combining national marketing power with strong local execution. A complete and formidable threat.', strengths: ['#1 Brand Recognition', 'Massive National Ad Budget', 'Standardized Systems', 'Excellent Local Reputation (5.0 Stars)'], weaknesses: ['Can be perceived as corporate/impersonal', 'Higher overhead may lead to higher prices'], services: ['Water Damage', 'Fire Damage', 'Mold Remediation', 'Carpet Cleaning'] },
            belfor: { name: 'Belfor', tier: 'national', threat: 'High', summary: 'Global leader in restoration, targeting large-loss commercial projects. Vulnerable on local accountability and service.', strengths: ['Global Scale & Resources', 'Exhaustive Service Portfolio', 'Strong B2B Relationships', 'Handles Massive Projects'], weaknesses: ['No physical Billings office', 'Documented poor customer service nationally', 'Impersonal corporate structure'], services: ['Water Damage', 'Fire Damage', 'Mold Remediation'] },
            paul_davis: { name: 'Paul Davis', tier: 'national', threat: 'Medium', summary: 'National franchise with a veteran-owned local branch. Brand is strong but plagued by negative national reviews.', strengths: ['Strong National Brand', 'Insurance Industry Preferred', 'Veteran-Owned Local Branch', 'Fast Response Times'], weaknesses: ['Highly polarized reviews', 'Reports of poor communication & quality nationally', 'Potential conflict of interest with insurance'], services: ['Water Damage', 'Fire Damage', 'Mold Remediation'] },
            faithful: { name: 'Faithful Disaster Restoration', tier: 'local', threat: 'High', summary: 'A dominant local force that has grown rapidly by building its brand on faith, trust, and exceptional customer service.', strengths: ['"Montana\'s Highest Rated"', 'Exceptional Reputation (4.9 Stars, 490+ reviews)', 'Rapid Growth & Scale', 'Strong, Trust-Based Brand'], weaknesses: ['Newer than AmeriClean', 'Faith-based branding may not resonate with all clients'], services: ['Water Damage', 'Fire Damage', 'Mold Remediation'] },
            alpha_omega: { name: 'Alpha Omega', tier: 'local', threat: 'High', summary: 'A sophisticated local expert backed by a national network (FLEET Response), offering true end-to-end reconstruction.', strengths: ['Hybrid Local/National Model', 'Largest Drying Capabilities in MT', 'Excellent Reputation (4.9 Stars)', 'Seamless Mitigation-to-Rebuild Service'], weaknesses: ['Smaller local team than some', 'Brand can be less known than pure nationals'], services: ['Water Damage', 'Fire Damage', 'Mold Remediation', 'Reconstruction'] },
            ecci: { name: 'ECCI', tier: 'niche', threat: 'Medium', summary: 'Montana\'s largest commercial janitorial contractor, a major threat for large B2B contracts with significant expansion capital.', strengths: ['Unmatched Commercial Scale', '$2.37M in Expansion Financing', 'One-Stop-Shop for Property Managers', 'A+ BBB Rating'], weaknesses: ['Brand focused on janitorial, not restoration', 'Poor reviews for residential division'], services: ['Carpet Cleaning', 'Commercial Janitorial'] },
            stanley_steemer: { name: 'Stanley Steemer', tier: 'niche', threat: 'Medium', summary: 'The household name for carpet cleaning. Competes directly on specialty services and leverages massive ad budgets.', strengths: ['Ubiquitous Brand Name', 'Promotional Pricing', 'EPA Safer Choice Partner', 'Broad Service Menu'], weaknesses: ['"Carpet cleaner" perception limits restoration credibility', 'Inconsistent quality nationally'], services: ['Carpet Cleaning', 'HVAC Cleaning', 'Water Damage'] },
        };

        const hvacData = [
            { name: 'Stanley Steemer', certified: false },
            { name: 'AmeriClean', certified: false },
            { name: 'Duct Hog', certified: false },
            { name: 'Comet Air Duct', certified: false },
            { name: 'AD Astra', certified: false },
            { name: 'Mr. C\'s', certified: false },
        ];

        const roadmapData = [
            { 
                phase: "Phase 1: Foundation",
                goal: "Achieve foundational dominance in local search and establish social proof.",
                actions: [
                    "<strong>Weaponize Authority:</strong> Brand the 'Pearson Protocol' and launch 'Ask the Expert' content series.",
                    "<strong>Local SEO Push:</strong> Optimize Google Business Profile and build local citations.",
                    "<strong>Reputation Management:</strong> Implement a system to aggressively solicit reviews on Google."
                ],
                duration: [0, 3] // Months
            },
            { 
                phase: "Phase 2: Expansion",
                goal: "Capture high-intent demand and establish authority through content.",
                actions: [
                    "<strong>Website Overhaul:</strong> Launch a modern, mobile-first website that reflects market leadership.",
                    "<strong>Targeted PPC Launch:</strong> Run Google Ads for high-value emergency keywords ('water damage Billings').",
                    "<strong>Launch 'Green' Initiative:</strong> Actively market a new 'Green & Healthy' service line."
                ],
                duration: [3, 9] // Months
            },
            { 
                phase: "Phase 3: Domination",
                goal: "Solidify position as the regional thought leader and expand reach.",
                actions: [
                    "<strong>B2B Outreach:</strong> Market the 'Investor Advantage Program' to real estate groups.",
                    "<strong>Video Marketing:</strong> Create professional video testimonials and process explanations.",
                    "<strong>Data-Driven Optimization:</strong> Continuously analyze marketing ROI and reallocate budget to the most profitable channels."
                ],
                duration: [9, 12] // Months
            }
        ];
        
        let activeCharts = [];

        function destroyActiveCharts() {
            activeCharts.forEach(chart => chart.destroy());
            activeCharts = [];
        }

        function renderCompetitors(filter = 'all') {
            competitorGrid.innerHTML = '';
            Object.entries(competitorData).forEach(([key, data]) => {
                if (filter === 'all' || data.tier === filter) {
                    const card = document.createElement('div');
                    card.className = `competitor-card bg-white p-5 rounded-lg shadow-sm border border-gray-200 flex flex-col`;
                    let threatColor = 'text-yellow-600';
                    if(data.threat === 'High') threatColor = 'text-red-600';
                    if(data.threat === 'Low') threatColor = 'text-green-600';
                    
                    let strengthsHTML = data.strengths.map(s => `<li class="text-sm">${s}</li>`).join('');
                    let weaknessesHTML = data.weaknesses.map(w => `<li class="text-sm">${w}</li>`).join('');

                    card.innerHTML = `
                        <h3 class="text-xl font-bold text-gray-900">${data.name}</h3>
                        <p class="text-sm font-semibold ${threatColor} mb-2">Threat Level: ${data.threat}</p>
                        <p class="text-gray-600 text-sm mb-4 flex-grow">${data.summary}</p>
                        <div>
                            <button class="accordion-button flex items-center justify-between w-full p-2 text-sm font-semibold text-left text-gray-700 bg-gray-100 hover:bg-gray-200 rounded">
                                <span>Strengths & Weaknesses</span>
                                <svg class="w-3 h-3 shrink-0 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                                <div class="pt-3">
                                    <h4 class="font-semibold text-green-700">Strengths</h4>
                                    <ul class="list-disc list-inside mt-1 text-green-600 space-y-1">${strengthsHTML}</ul>
                                    <h4 class="font-semibold text-red-700 mt-3">Weaknesses</h4>
                                    <ul class="list-disc list-inside mt-1 text-red-600 space-y-1">${weaknessesHTML}</ul>
                                </div>
                            </div>
                        </div>
                    `;
                    competitorGrid.appendChild(card);
                }
            });
        }
        
        function renderHvacTable() {
            const tbody = document.getElementById('hvac-table-body');
            tbody.innerHTML = hvacData.map(c => `
                <tr>
                    <td class="p-3 font-medium">${c.name}</td>
                    <td class="p-3 text-center"><span class="text-red-500 font-bold text-lg">‚úó</span></td>
                </tr>
            `).join('');
        }

        function renderRoadmap() {
            const container = document.getElementById('roadmap-accordion');
            container.innerHTML = roadmapData.map((item, index) => `
                <div class="border border-gray-200 rounded-lg">
                    <h2>
                        <button type="button" class="accordion-button flex items-center justify-between w-full p-4 font-semibold text-left text-gray-800 bg-gray-50 hover:bg-gray-100" data-accordion-target="#roadmap-content-${index}">
                            <span>${item.phase}</span>
                            <svg class="w-4 h-4 shrink-0 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                    </h2>
                    <div id="roadmap-content-${index}" class="accordion-content">
                        <div class="p-4 border-t border-gray-200">
                            <p class="font-medium text-gray-700 mb-2">${item.goal}</p>
                            <ul class="list-disc list-inside space-y-1 text-gray-600">${item.actions.map(a => `<li>${a}</li>`).join('')}</ul>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function performResearch() {
            const companyName = researchInput.value.trim();
            if (!companyName) {
                researchResultsContainer.innerHTML = `<p class="text-center text-red-500">Please enter a company name to research.</p>`;
                return;
            }

            researchResultsContainer.innerHTML = `<div class="loader"></div>`;

            try {
                const response = await new Promise(resolve => setTimeout(() => {
                    resolve({
                        overview: `An automated analysis suggests ${companyName} is a competitor in the Billings, MT area. Key focus appears to be on residential and commercial cleaning services, with some indication of specialty offerings.`,
                        onlinePresence: [
                            { name: 'Official Website', url: '#', icon: 'üåê' },
                            { name: 'Google Business Profile', url: '#', icon: '‚≠ê' },
                            { name: 'Facebook Page', url: '#', icon: 'üëç' }
                        ],
                        services: ['General Commercial Cleaning', 'Residential Maid Service', 'Carpet Cleaning', 'Possible Water Damage Mitigation (low confidence)'],
                        assessment: `Based on automated analysis, ${companyName} appears to be a Tier 3 (Niche Specialist) competitor. Their primary threat is likely in price-sensitive residential and small commercial cleaning jobs. Their brand recognition appears moderate. A key counter-strategy would be to emphasize AmeriClean's superior certifications (IICRC, EPA) and specialized expertise in high-stakes restoration, which ${companyName} likely lacks.`
                    });
                }, 1500));

                researchResultsContainer.innerHTML = generateReportHTML(companyName, response);
                
                document.getElementById('add-competitor-btn').addEventListener('click', function() {
                    addCompetitor(companyName, response, this);
                });

            } catch (error) {
                researchResultsContainer.innerHTML = `<p class="text-center text-red-500">An error occurred during research. Please try again.</p>`;
                console.error("Research error:", error);
            }
        }
        
        function addCompetitor(companyName, researchData, buttonElement) {
            const newKey = companyName.toLowerCase().replace(/\s+/g, '_');
            if (competitorData[newKey]) {
                alert('This competitor has already been added.');
                return;
            }

            competitorData[newKey] = {
                name: companyName,
                tier: 'niche',
                threat: 'Medium',
                summary: researchData.overview,
                strengths: ['Targets price-sensitive jobs', 'Moderate brand recognition (inferred)'],
                weaknesses: ['Lacks IICRC/EPA certifications (inferred)', 'Lacks specialized restoration expertise (inferred)'],
                services: ['Carpet Cleaning', 'Commercial Janitorial']
            };
            
            buttonElement.textContent = 'Added ‚úì';
            buttonElement.disabled = true;
            buttonElement.classList.remove('bg-green-600', 'hover:bg-green-700');
            buttonElement.classList.add('bg-gray-400', 'cursor-not-allowed');

            const competitorTab = document.querySelector('button[data-tab="competitors"]');
            competitorTab.click();
            
            const allFilterButton = document.querySelector('#competitor-tier-selector button[data-tier="all"]');
            allFilterButton.click();
        }

        function generateReportHTML(companyName, data) {
            const presenceHTML = data.onlinePresence.map(p => `
                <a href="${p.url}" target="_blank" rel="noopener noreferrer" class="flex items-center bg-gray-100 hover:bg-gray-200 p-3 rounded-md transition-colors">
                    <span class="text-2xl mr-3">${p.icon}</span>
                    <span class="font-medium text-blue-600">${p.name}</span>
                </a>
            `).join('');

            const servicesHTML = data.services.map(s => `<li class="text-gray-700">${s}</li>`).join('');

            return `
                <div class="bg-white p-6 rounded-lg shadow-sm animate-fade-in">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Automated Report: ${companyName}</h3>
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">Company Overview</h4>
                            <p class="text-gray-700">${data.overview}</p>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">Online Presence</h4>
                            <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">${presenceHTML}</div>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">Inferred Services</h4>
                            <ul class="list-disc list-inside space-y-1">${servicesHTML}</ul>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">Initial Strategic Assessment</h4>
                            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
                                <p class="text-yellow-800">${data.assessment}</p>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <button id="add-competitor-btn" class="bg-green-600 text-white font-bold py-2 px-6 rounded-md hover:bg-green-700 transition-colors">Add to Competitor Analysis</button>
                    </div>
                    <p class="text-xs text-gray-400 mt-6 text-center">Disclaimer: This report is generated automatically based on a simulated analysis of public data and should be used as a starting point for further investigation.</p>
                </div>
                <style>
                    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
                    .animate-fade-in { animation: fade-in 0.5s ease-out; }
                </style>
            `;
        }
        
        function generateStrategicSynthesis() {
            destroyActiveCharts();
            synthesisReportContainer.innerHTML = '';
            synthesisReportContainer.classList.remove('hidden');

            const allCompetitors = Object.values(competitorData);
            
            const serviceCounts = {};
            allCompetitors.forEach(c => {
                c.services.forEach(s => {
                    serviceCounts[s] = (serviceCounts[s] || 0) + 1;
                });
            });
            
            const roadmapHTML = roadmapData.map(item => `
                <div class="mb-4">
                    <h4 class="font-bold text-lg text-indigo-800">${item.phase} (${item.duration[1] - item.duration[0]} Months)</h4>
                    <p class="font-medium text-gray-700 mb-2">${item.goal}</p>
                    <ul class="list-disc list-inside space-y-1 text-gray-600">${item.actions.map(a => `<li>${a}</li>`).join('')}</ul>
                </div>
            `).join('');

            const reportHTML = `
                <div class="bg-white p-6 rounded-lg shadow-md mb-8 animate-fade-in">
                    <h2 class="text-3xl font-bold text-center mb-2 text-gray-900">Dynamic Strategic Synthesis</h2>
                    <p class="text-center text-gray-500 mb-6">Generated on ${new Date().toLocaleDateString()} based on ${allCompetitors.length} known competitors.</p>
                    
                    <div class="grid lg:grid-cols-2 gap-8 mb-8">
                        <div class="bg-gray-50 p-4 rounded-lg border">
                            <h3 class="text-xl font-semibold text-center mb-4">Competitive Landscape Overview</h3>
                            <div class="synthesis-chart-container"><canvas id="threatMatrixChart"></canvas></div>
                            <p class="text-xs text-center text-gray-500 mt-2">This matrix plots competitors by their market power (tier) and threat level. AmeriClean should focus on strategies that counter the "High/High" quadrant while defending against niche players.</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg border">
                            <h3 class="text-xl font-semibold text-center mb-4">Service Market Saturation</h3>
                            <div class="synthesis-chart-container"><canvas id="serviceOverlapChart"></canvas></div>
                            <p class="text-xs text-center text-gray-500 mt-2">This chart shows how many competitors offer key services. Lower bars represent less competition and higher strategic opportunity for AmeriClean.</p>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-semibold mb-4 text-gray-800 border-b pb-2">Key Strategic Insights & Recommendations</h3>
                        <div class="space-y-4">
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-bold text-green-800">Key Strength to Leverage: Unmatched Expertise</h4>
                                <p class="text-green-700 mt-1">AmeriClean's 45-year history and owner's role in setting industry standards remain its most powerful, defensible asset. This must be the core of all marketing to justify premium value against all competitor types.</p>
                            </div>
                            <div class="bg-red-50 p-4 rounded-lg">
                                <h4 class="font-bold text-red-800">Identified Vulnerability: Service Gaps</h4>
                                <p class="text-red-700 mt-1">Competitors like Alpha Omega offer full reconstruction services, creating a "one-stop-shop" advantage. AmeriClean should formalize partnerships with trusted contractors to counter this and offer a seamless client experience.</p>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-bold text-blue-800">Top Opportunity: Dominate Niche Markets</h4>
                                <p class="text-blue-700 mt-1">The analysis shows minimal competition in specialized areas like Hoarder Resolution and certified HVAC cleaning. Focusing marketing on these "blue ocean" services can yield high-margin revenue with less competitive pressure.</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-2xl font-semibold mb-4 text-gray-800 border-b pb-2">Action Plan & Budget</h3>
                        <div class="grid lg:grid-cols-5 gap-8">
                            <div class="lg:col-span-3">
                                ${roadmapHTML}
                            </div>
                            <div class="lg:col-span-2 bg-gray-50 p-4 rounded-lg border">
                                <h4 class="font-semibold text-lg text-center mb-2">Proposed 12-Month Budget Allocation</h4>
                                <div class="synthesis-chart-container h-56"><canvas id="budgetAllocationChart"></canvas></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            synthesisReportContainer.innerHTML = reportHTML;
            
            // Render Charts
            const threatCtx = document.getElementById('threatMatrixChart').getContext('2d');
            const threatData = allCompetitors.map(c => {
                let x = 1; // Niche
                if (c.tier === 'local') x = 2;
                if (c.tier === 'national') x = 3;
                let y = 1; // Low
                if (c.threat === 'Medium') y = 2;
                if (c.threat === 'High') y = 3;
                let r = 10; // Low
                if (c.threat === 'Medium') r = 15;
                if (c.threat === 'High') r = 20;
                
                let color = 'rgba(252, 211, 77, 0.7)'; // Yellow for Low
                if (c.threat === 'Medium') color = 'rgba(249, 115, 22, 0.7)'; // Orange for Medium
                if (c.threat === 'High') color = 'rgba(220, 38, 38, 0.7)'; // Red for High
                
                return { x, y, r, label: c.name, backgroundColor: color };
            });
            
            activeCharts.push(new Chart(threatCtx, {
                type: 'bubble',
                data: { datasets: [{ label: 'Competitors', data: threatData }] },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Market Power / Scale' }, min: 0, max: 4, ticks: { stepSize: 1, callback: val => ['','Niche','Local','National'][val] || '' } },
                        y: { title: { display: true, text: 'Threat Level' }, min: 0, max: 4, ticks: { stepSize: 1, callback: val => ['','Low','Medium','High'][val] || '' } }
                    },
                    plugins: { tooltip: { callbacks: { label: ctx => ctx.raw.label } } }
                }
            }));

            const serviceCtx = document.getElementById('serviceOverlapChart').getContext('2d');
            activeCharts.push(new Chart(serviceCtx, {
                type: 'polarArea',
                data: {
                    labels: Object.keys(serviceCounts),
                    datasets: [{
                        label: 'Number of Competitors',
                        data: Object.values(serviceCounts),
                        backgroundColor: ['rgba(59, 130, 246, 0.5)', 'rgba(239, 68, 68, 0.5)', 'rgba(16, 185, 129, 0.5)', 'rgba(249, 115, 22, 0.5)', 'rgba(139, 92, 246, 0.5)']
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            }));

            const budgetCtx = document.getElementById('budgetAllocationChart').getContext('2d');
            activeCharts.push(new Chart(budgetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['SEO & Content', 'PPC Advertising', 'Website/Tech', 'B2B Outreach'],
                    datasets: [{ data: [45, 35, 10, 10], backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#6366F1'] }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            }));
        }

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const targetId = tab.dataset.tab;
                tabs.forEach(t => t.classList.replace('tab-active', 'tab-inactive'));
                tab.classList.replace('tab-inactive', 'tab-active');
                sections.forEach(section => {
                    section.classList.remove('content-active');
                    if (section.id === targetId) section.classList.add('content-active');
                });
            });
        });

        competitorTierSelector.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const tier = e.target.dataset.tier;
                document.querySelectorAll('.tier-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                e.target.classList.add('bg-blue-600', 'text-white');
                e.target.classList.remove('bg-gray-200', 'text-gray-700');
                renderCompetitors(tier);
                synthesisReportContainer.classList.add('hidden');
                destroyActiveCharts();
            }
        });

        researchButton.addEventListener('click', performResearch);
        researchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                performResearch();
            }
        });

        synthesisButton.addEventListener('click', generateStrategicSynthesis);

        window.addEventListener('DOMContentLoaded', () => {
            renderCompetitors();
            renderHvacTable();
            renderRoadmap();

            document.querySelector('main').addEventListener('click', function(e) {
                const button = e.target.closest('.accordion-button');
                if (!button) return;

                let content;
                const roadmapTarget = button.dataset.accordionTarget;
                if (roadmapTarget) {
                    content = document.querySelector(roadmapTarget);
                } else {
                    content = button.nextElementSibling;
                }

                if (!content || !content.classList.contains('accordion-content')) return;

                const icon = button.querySelector('svg');
                const isExpanded = content.style.maxHeight;
                const container = button.closest('.grid, .space-y-3');

                if (container) {
                    container.querySelectorAll('.accordion-content').forEach(el => {
                        el.style.maxHeight = null;
                    });
                    container.querySelectorAll('.accordion-button svg').forEach(svgIcon => {
                        svgIcon.style.transform = 'rotate(0deg)';
                    });
                }

                if (!isExpanded) {
                    content.style.maxHeight = content.scrollHeight + "px";
                    icon.style.transform = 'rotate(180deg)';
                }
            });

            const timelineCtx = document.getElementById('timelineChart').getContext('2d');
            activeCharts.push(new Chart(timelineCtx, {
                type: 'bar',
                data: {
                    labels: roadmapData.map(d => d.phase),
                    datasets: [{
                        label: 'Duration (Months)',
                        data: roadmapData.map(d => d.duration),
                        backgroundColor: ['rgba(59, 130, 246, 0.7)', 'rgba(16, 185, 129, 0.7)', 'rgba(249, 115, 22, 0.7)'],
                        barPercentage: 0.5,
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: {
                            min: 0, max: 12,
                            title: { display: true, text: 'Months' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (ctx) => `Months ${ctx.raw[0]} to ${ctx.raw[1]}`
                            }
                        }
                    }
                }
            }));
            
            const roadmapBudgetCtx = document.getElementById('roadmapBudgetAllocationChart').getContext('2d');
            activeCharts.push(new Chart(roadmapBudgetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['SEO & Content', 'PPC Advertising', 'Website/Tech', 'B2B Outreach'],
                    datasets: [{ data: [45, 35, 10, 10], backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#6366F1'] }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { boxWidth: 12 } } } }
            }));
        });
    </script>
</body>
</html>
